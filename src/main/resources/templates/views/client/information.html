<!DOCTYPE html>
<html lang="en" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{decorator/web}" xmlns:th="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>Tree Shop - Client</title>
</head>
<body>
<div layout:fragment="~{content}">
    <section class="user spad">
        <div class="container">
            <div class="row">
                <div class="col-lg-3 pb-3">
                    <ul class="nav nav-tabs flex-column" role="tablist">
                        <li class="nav-item" role="presentation">
                            <a class="nav-link active" data-toggle="tab" href="#tabs-1" role="tab" aria-selected="true">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                     class="bi bi-person-bounding-box" viewBox="0 0 16 16">
                                    <path d="M1.5 1a.5.5 0 0 0-.5.5v3a.5.5 0 0 1-1 0v-3A1.5 1.5 0 0 1 1.5 0h3a.5.5 0 0 1 0 1h-3zM11 .5a.5.5 0 0 1 .5-.5h3A1.5 1.5 0 0 1 16 1.5v3a.5.5 0 0 1-1 0v-3a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 1-.5-.5zM.5 11a.5.5 0 0 1 .5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 1 0 1h-3A1.5 1.5 0 0 1 0 14.5v-3a.5.5 0 0 1 .5-.5zm15 0a.5.5 0 0 1 .5.5v3a1.5 1.5 0 0 1-1.5 1.5h-3a.5.5 0 0 1 0-1h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 1 .5-.5z"/>
                                    <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm8-9a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
                                </svg>
                                <h7>Thông tin cá nhân</h7>

                            </a>
                        </li>
                        <li class="nav-item" role="presentation">
                            <a class="nav-link" data-toggle="tab" href="#tabs-2" role="tab" aria-selected="false">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-shield-lock"
                                     viewBox="0 0 16 16">
                                    <path d="M5.338 1.59a61.44 61.44 0 0 0-2.837.856.481.481 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.725 10.725 0 0 0 2.287 2.233c.346.244.652.42.893.533.12.057.218.095.293.118a.55.55 0 0 0 .101.025.615.615 0 0 0 .1-.025c.076-.023.174-.061.294-.118.24-.113.547-.29.893-.533a10.726 10.726 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.775 11.775 0 0 1-2.517 2.453 7.159 7.159 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7.158 7.158 0 0 1-1.048-.625 11.777 11.777 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 62.456 62.456 0 0 1 5.072.56z"/>
                                    <path d="M9.5 6.5a1.5 1.5 0 0 1-1 1.415l.385 1.99a.5.5 0 0 1-.491.595h-.788a.5.5 0 0 1-.49-.595l.384-1.99a1.5 1.5 0 1 1 2-1.415z"/>
                                </svg>
                                <h7>Đổi mật khẩu</h7>
                            </a>
                        </li>
                        <li class="nav-item" role="presentation">
                            <a class="nav-link" data-toggle="tab" href="#tabs-3" role="tab" aria-selected="false">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-receipt"
                                     viewBox="0 0 16 16">
                                    <path d="M1.92.506a.5.5 0 0 1 .434.14L3 1.293l.646-.647a.5.5 0 0 1 .708 0L5 1.293l.646-.647a.5.5 0 0 1 .708 0L7 1.293l.646-.647a.5.5 0 0 1 .708 0L9 1.293l.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .801.13l.5 1A.5.5 0 0 1 15 2v12a.5.5 0 0 1-.053.224l-.5 1a.5.5 0 0 1-.8.13L13 14.707l-.646.647a.5.5 0 0 1-.708 0L11 14.707l-.646.647a.5.5 0 0 1-.708 0L9 14.707l-.646.647a.5.5 0 0 1-.708 0L7 14.707l-.646.647a.5.5 0 0 1-.708 0L5 14.707l-.646.647a.5.5 0 0 1-.708 0L3 14.707l-.646.647a.5.5 0 0 1-.801-.13l-.5-1A.5.5 0 0 1 1 14V2a.5.5 0 0 1 .053-.224l.5-1a.5.5 0 0 1 .367-.27zm.217 1.338L2 2.118v11.764l.137.274.51-.51a.5.5 0 0 1 .707 0l.646.647.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.509.509.137-.274V2.118l-.137-.274-.51.51a.5.5 0 0 1-.707 0L12 1.707l-.646.647a.5.5 0 0 1-.708 0L10 1.707l-.646.647a.5.5 0 0 1-.708 0L8 1.707l-.646.647a.5.5 0 0 1-.708 0L6 1.707l-.646.647a.5.5 0 0 1-.708 0L4 1.707l-.646.647a.5.5 0 0 1-.708 0l-.509-.51z"/>
                                    <path d="M3 4.5a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5zm8-6a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5z"/>
                                </svg>
                                <h7>Đơn hàng của tôi</h7>
                            </a>
                        </li>
                        <li class="nav-item" role="presentation">
                            <a class="nav-link" data-toggle="tab" href="#tabs-4" role="tab" aria-selected="false">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                     class="bi bi-calendar2-heart" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd"
                                          d="M4 .5a.5.5 0 0 0-1 0V1H2a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-1V.5a.5.5 0 0 0-1 0V1H4V.5ZM1 3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V3Zm2 .5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h10a.5.5 0 0 0 .5-.5V4a.5.5 0 0 0-.5-.5H3Zm5 4.493c1.664-1.711 5.825 1.283 0 5.132-5.825-3.85-1.664-6.843 0-5.132Z"/>
                                </svg>
                                <h7>Sản phẩm yêu thích</h7>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="col-lg-9">
                    <div class="tab-content">
                        <div class="tab-pane fade show active" id="tabs-1" role="tabpanel">
                            <div class="edit-user">
                                <div class="p-1 py-4" th:if="${session.client}">
                                    <form th:action="@{'/home/save/' + ${session.client.username}+'/information'}"
                                          method="post"
                                          th:object="${informationOfClient}">
                                        <div class="d-flex justify-content-between align-items-center mb-3 border-bottom">
                                            <h4 class="text-right py-2 ">Thông tin cá nhân: </h4>
                                        </div>
                                        <div class="row mt-2">
                                            <div class="col-md-6"><label class="labels">Họ và tên</label><input
                                                    type="text"
                                                    class="form-control"
                                                    pattern="[a-zA-ZàáạảãâầấậẩẫăằắặẳẵÀÁẠẢÃÂẦẤẬẨẪĂẰẮẶẲẴèéẹẻẽêềếệểễÈÉẸẺẼÊỀẾỆỂỄìíịỉĩÌÍỊỈĨòóọỏõôồốộổỗơờớợởỡÒÓỌỎÕÔỒỐỘỔỖƠỜỚỢỞỠùúụủũưừứựửữÙÚỤỦŨƯỪỨỰỬỮỳýỵỷỹỲÝỴỶỸđĐ ]{0,100}"
                                                    title="Chỉ bao gồm chữ, tối đa 100 kí tự!"
                                                    th:field="*{fullname}">
                                            </div>
                                            <div class="col-md-6"><label class="labels">Số điện thoại</label><input
                                                    type="text"
                                                    class="form-control"
                                                    pattern="[0-9]{8,10}"
                                                    title="Chỉ bao gồm số, giới hạn từ 8 đến 10 số!"
                                                    placeholder="Số điện thoại"
                                                    th:field="*{phoneNumber}">
                                            </div>
                                        </div>
                                        <div class="row mt-3">
                                            <div class="col-md-6"><label class="labels">Địa chỉ</label><input
                                                    type="text" class="form-control" th:field="*{address}">
                                            </div>
                                            <div class="col-md-6"><label class="labels">Email</label><input type="email"
                                                                                                            class="form-control"
                                                                                                            th:field="*{email}">
                                            </div>
                                        </div>
                                        <div class="mt-5 text-center">
                                            <button class="btn btn-primary profile-button" type="submit">Lưu thông tin
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade show" id="tabs-2" role="tabpanel">
                            <div class="change-password">
                                <div class="p-1 py-4 al">
                                    <div class="d-flex justify-content-between align-items-center mb-3 border-bottom">
                                        <h4 class="text-right py-2 ">Cập nhật mật khẩu</h4>
                                    </div>
                                    <div class="form centered" th:if="${session.client}">
                                        <form>
                                            <div class="row mt-3">
                                                <div class="col-md-12"><label class="labels">Mật khẩu cũ</label><input
                                                        id="oldPassword" type="password" class="form-control"
                                                        required></div>
                                            </div>
                                            <div class="row mt-3">
                                                <div class="col-md-12"><label class="labels">Mật khẩu mới</label><input
                                                        type="password" class="form-control" id="newPass"
                                                        onkeyup="checkPass()" required></div>
                                            </div>
                                            <div class="row mt-3">
                                                <div class="col-md-12"><label class="labels">Nhập lại mật khẩu
                                                    mới</label><input id="conFPass" type="password" class="form-control"
                                                                      onkeyup="checkPass()" required>
                                                </div>
                                                <div class="col-md-12"><span id='message'></span></div>
                                            </div>
                                            <div class="mt-5 text-center">
                                                <button class="btn btn-primary profile-button" type="button"
                                                        id="submit-password" onclick="changePassword()">Cập nhật mật
                                                    khẩu
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade show" id="tabs-3" role="tabpanel">
                            <div class="history-order py-4 pb-5">
                                <div class="d-flex justify-content-between align-items-center mb-3 border-bottom">
                                    <h4 class="text-right py-2 ">Đơn hàng của tôi</h4>
                                </div>
                                <ul class="nav nav-tabs nav-justified py-10" role="tablist">
                                    <li class="nav-item" role="presentation">
                                        <a class="nav-link active" data-toggle="tab" href="#tabs-5" role="tab"
                                           aria-selected="true">Tất cả</a>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <a class="nav-link" data-toggle="tab" href="#tabs-9" role="tab"
                                           aria-selected="false">Chờ xác nhận</a>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <a class="nav-link" data-toggle="tab" href="#tabs-6" role="tab"
                                           aria-selected="false">Đang Giao</a>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <a class="nav-link" data-toggle="tab" href="#tabs-7" role="tab"
                                           aria-selected="false">Đã Giao</a>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <a class="nav-link" data-toggle="tab" href="#tabs-8" role="tab"
                                           aria-selected="false">Đã Hủy</a>
                                    </li>
                                </ul>
                                <div class="history-order-details tab-content">
                                    <div class="tab-pane fade show active" id="tabs-5" role="tabpanel">
                                        <div class="all-order">
                                            <div class="card mt-2 bg-light" th:each="order : ${listOrderOfClient}">
                                                <div class="card-header">
                                                    <div class="row">
                                                        <div class="col-lg-6">
                                                            <a class="id-status-order">[[${order.orderId}]] |
                                                                <span th:switch="${order.status}">
                                                                    <span th:case="null">
                                                                        Rỗng
                                                                    </span>
                                                                    <span th:case="${T(com.treeshop.entity.StatusOfOrder).WAIT_CONFIRM}"
                                                                          class="label label-grey">
                                                                        Chờ xác nhận
                                                                    </span>
                                                                    <span th:case="${T(com.treeshop.entity.StatusOfOrder).CONFIRMED}"
                                                                          class="label label-grey">
                                                                        Đã xác nhận
                                                                    </span>
                                                                    <span th:case="${T(com.treeshop.entity.StatusOfOrder).DELIVERY}"
                                                                          class="label label-warning">
                                                                        Đang giao hàng
                                                                    </span>
                                                                    <span th:case="${T(com.treeshop.entity.StatusOfOrder).DELIVERED}"
                                                                          class="label label-sm label-info arrowed arrowed-righ">
                                                                        Đã giao hàng
                                                                    </span>
                                                                    <span th:case="${T(com.treeshop.entity.StatusOfOrder).CANCELLED}"
                                                                          class="label label-sm label-inverse arrowed-in">
                                                                        Đã hủy
                                                                    </span>
                                                                </span>
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="history__order__table card-body">
                                                    <table>
                                                        <thead>
                                                        <tr>
                                                            <th class="shoping__product">Sản phẩm</th>
                                                            <th>Đơn giá</th>
                                                            <th>Tạm tính</th>
                                                        </tr>
                                                        </thead>
                                                        <tbody>
                                                        <tr th:each="item : ${order.lineItemEntityList}">
                                                            <td class="shoping__cart__item">
                                                                <img th:src="@{${item.productsEntity.getPhotosImagePath()}}"
                                                                     alt="">
                                                                <h5 class="align-middle"><span
                                                                        th:text="${item.getProductName()}"></span>
                                                                    (x[[${item.quantity}]])</h5>
                                                            </td>
                                                            <td><span
                                                                    th:text="${#numbers.formatDecimal(item.price  , 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                            </td>
                                                            <td>
                                                                <span th:text="${#numbers.formatDecimal(item.getTotalPerProduct(), 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                            </td>
                                                        </tr>
                                                        </tbody>
                                                        <tfoot>
                                                        <tr>
                                                            <td class="order-pay-infor" colspan="2">Tổng tiền
                                                                hàng</td>
                                                            <td th:if="${order.codeId != null}" class="order-pay-fee">
                                                                <span th:text="${#numbers.formatDecimal(order.totalPrice * 100 / (100 - order.discountCodeEntity.discountPercent), 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                            </td>
                                                            <td th:if="${order.codeId == null}" class="order-pay-fee">
                                                                <span th:text="${#numbers.formatDecimal(order.totalPrice, 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                            </td>
                                                        </tr>
                                                        <!--                                                        <tr>-->
                                                        <!--                                                            <td class="order-pay-infor" colspan="2">Phí vận chuyển</td>-->
                                                        <!--                                                            <td class="order-pay-fee">60.000₫</td>-->
                                                        <!--                                                        </tr>-->
                                                        <tr th:if="${order.codeId != null}">
                                                            <td class="order-pay-infor" colspan="2">Giảm giá</td>
                                                            <td class="order-pay-fee">
                                                                [[${order.discountCodeEntity.discountPercent}]] %
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td class="order-pay-infor" colspan="2">Tổng số tiền</td>
                                                            <td class="order-pay-fee">
                                                                <span th:text="${#numbers.formatDecimal(order.totalPrice, 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                            </td>
                                                        </tr>
                                                        <tr th:switch="${order.status}">
                                                            <td colspan="3" class="border-top"
                                                                th:case="${T(com.treeshop.entity.StatusOfOrder).WAIT_CONFIRM}">
                                                                <button type="button"
                                                                        class="btn-cancel_order btn btn-primary text-right cancel-order-btn"
                                                                        data-toggle="modal"
                                                                        data-target="#cancelModalCenter"
                                                                        th:id="${order.orderId}">Hủy đơn
                                                                </button>
                                                            </td>
                                                            <td colspan="3" class="border-top"
                                                                th:case="${T(com.treeshop.entity.StatusOfOrder).DELIVERED}">
                                                                <button
                                                                        type="button"
                                                                        class="btn-reorder btn btn-primary text-right"
                                                                        th:onclick="buyOrderAgain([[${order.orderId}]], this)">
                                                                    Mua lại
                                                                </button>
                                                                <button th:if="${order.review_flg == false}"
                                                                        type="button"
                                                                        class="btn-review btn btn-primary text-right review-btn"
                                                                        data-toggle="modal"
                                                                        data-target="#reviewModalCenter"
                                                                        th:name="${order.orderId}">Đánh giá
                                                                </button>
                                                                <button th:if="${order.review_flg == true}"
                                                                        type="button"
                                                                        class="btn-review btn btn-primary text-right read-reviewed-btn"
                                                                        data-toggle="modal"
                                                                        data-target="#readReviewModalCenter"
                                                                        th:name="${order.orderId}">Xem đánh giá
                                                                </button>
                                                            </td>
                                                            <td colspan="3" class="border-top"
                                                                th:case="${T(com.treeshop.entity.StatusOfOrder).CANCELLED}">
                                                                <button type="button"
                                                                        class="btn-reorder btn btn-primary text-right"
                                                                        th:onclick="buyOrderAgain([[${order.orderId}]], this)">
                                                                    Mua lại
                                                                </button>
                                                            </td>
                                                        </tr>
                                                        </tfoot>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade show" id="tabs-9" role="tabpanel">
                                        <div class="waiting-order">
                                            <th:block th:each="order : ${listOrderOfClient}">
                                                <div class="card mt-2 bg-light"
                                                     th:if="${order.status == T(com.treeshop.entity.StatusOfOrder).WAIT_CONFIRM}">
                                                    <div>
                                                        <div class="card-header">
                                                            <div class="row">
                                                                <div class="col-lg-6">
                                                                    <a class="id-status-order">[[${order.orderId}]] |
                                                                        Chờ xác nhận</a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="history__order__table card-body">
                                                            <table>
                                                                <thead>
                                                                <tr>
                                                                    <th class="shoping__product">Sản phẩm</th>
                                                                    <th>Đơn giá</th>
                                                                    <th>Tạm tính</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody>
                                                                <tr th:each="item : ${order.lineItemEntityList}">
                                                                    <td class="shoping__cart__item">
                                                                        <img th:src="@{${item.productsEntity.getPhotosImagePath()}}"
                                                                             alt="">
                                                                        <h5 class="align-middle"><span
                                                                                th:text="${item.getProductName()}"></span>
                                                                            (x[[${item.quantity}]])</h5>
                                                                    </td>
                                                                    <td><span
                                                                            th:text="${#numbers.formatDecimal(item.price  , 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                                    </td>
                                                                    <td>
                                                                        <span th:text="${#numbers.formatDecimal(item.getTotalPerProduct(), 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                                    </td>
                                                                </tr>
                                                                </tbody>
                                                                <tfoot>
                                                                <tr>
                                                                    <td class="order-pay-infor" colspan="2">Tổng tiền
                                                                        hàng
                                                                    </td>
                                                                    <td th:if="${order.codeId != null}"
                                                                        class="order-pay-fee">
                                                                        <span th:text="${#numbers.formatDecimal(order.totalPrice * 100 / (100 - order.discountCodeEntity.discountPercent), 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                                    </td>
                                                                    <td th:if="${order.codeId == null}"
                                                                        class="order-pay-fee">
                                                                        <span th:text="${#numbers.formatDecimal(order.totalPrice, 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                                    </td>
                                                                </tr>
                                                                <tr th:if="${order.codeId != null}">
                                                                    <td class="order-pay-infor" colspan="2">Giảm giá
                                                                    </td>
                                                                    <td class="order-pay-fee">
                                                                        [[${order.discountCodeEntity.discountPercent}]]
                                                                        %
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="order-pay-infor" colspan="2">Tổng số
                                                                        tiền
                                                                    </td>
                                                                    <td class="order-pay-fee">
                                                                        <span th:text="${#numbers.formatDecimal(order.totalPrice, 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td colspan="3" class="border-top"
                                                                    >
                                                                        <button type="button"
                                                                                class="btn-cancel_order btn btn-primary text-right cancel-order-btn"
                                                                                data-toggle="modal"
                                                                                data-target="#cancelModalCenter"
                                                                                th:id="${order.orderId}">Hủy đơn
                                                                        </button>
                                                                    </td>
                                                                </tr>
                                                                </tfoot>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </th:block>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade show" id="tabs-6" role="tabpanel">
                                        <div class="delivering-order">
                                            <th:block th:each="order : ${listOrderOfClient}">
                                                <div class="card mt-2 bg-light"
                                                     th:if="${order.status == T(com.treeshop.entity.StatusOfOrder).DELIVERY}">
                                                    <div>
                                                        <div class="card-header">
                                                            <div class="row">
                                                                <div class="col-lg-6">
                                                                    <a class="id-status-order">[[${order.orderId}]] |
                                                                        Đang giao hàng</a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="history__order__table card-body">
                                                            <table>
                                                                <thead>
                                                                <tr>
                                                                    <th class="shoping__product">Sản phẩm</th>
                                                                    <th>Đơn giá</th>
                                                                    <th>Tạm tính</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody>
                                                                <tr th:each="item : ${order.lineItemEntityList}">
                                                                    <td class="shoping__cart__item">
                                                                        <img th:src="@{${item.productsEntity.getPhotosImagePath()}}"
                                                                             alt="">
                                                                        <h5 class="align-middle"><span
                                                                                th:text="${item.getProductName()}"></span>
                                                                            (x[[${item.quantity}]])</h5>
                                                                    </td>
                                                                    <td><span
                                                                            th:text="${#numbers.formatDecimal(item.price  , 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                                    </td>
                                                                    <td>
                                                                        <span th:text="${#numbers.formatDecimal(item.getTotalPerProduct(), 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                                    </td>
                                                                </tr>
                                                                </tbody>
                                                                <tfoot>
                                                                <tr>
                                                                    <td class="order-pay-infor" colspan="2">Tổng tiền
                                                                        hàng
                                                                    </td>
                                                                    <td th:if="${order.codeId != null}"
                                                                        class="order-pay-fee">
                                                                        <span th:text="${#numbers.formatDecimal(order.totalPrice * 100 / (100 - order.discountCodeEntity.discountPercent), 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                                    </td>
                                                                    <td th:if="${order.codeId == null}"
                                                                        class="order-pay-fee">
                                                                        <span th:text="${#numbers.formatDecimal(order.totalPrice, 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                                    </td>
                                                                </tr>
                                                                <tr th:if="${order.codeId != null}">
                                                                    <td class="order-pay-infor" colspan="2">Giảm giá
                                                                    </td>
                                                                    <td class="order-pay-fee">
                                                                        [[${order.discountCodeEntity.discountPercent}]]
                                                                        %
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="order-pay-infor" colspan="2">Tổng số
                                                                        tiền
                                                                    </td>
                                                                    <td class="order-pay-fee">
                                                                        <span th:text="${#numbers.formatDecimal(order.totalPrice, 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                                    </td>
                                                                </tr>
                                                                </tfoot>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </th:block>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade show" id="tabs-7" role="tabpanel">
                                        <div class="success-order">
                                            <th:block th:each="order : ${listOrderOfClient}">
                                                <div class="card mt-2 bg-light"
                                                     th:if="${order.status == T(com.treeshop.entity.StatusOfOrder).DELIVERED}">
                                                    <div>
                                                        <div class="card-header">
                                                            <div class="row">
                                                                <div class="col-lg-6">
                                                                    <a class="id-status-order">[[${order.orderId}]] | Đã
                                                                        giao hàng</a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="history__order__table card-body">
                                                            <table>
                                                                <thead>
                                                                <tr>
                                                                    <th class="shoping__product">Sản phẩm</th>
                                                                    <th>Đơn giá</th>
                                                                    <th>Tạm tính</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody>
                                                                <tr th:each="item : ${order.lineItemEntityList}">
                                                                    <td class="shoping__cart__item">
                                                                        <img th:src="@{${item.productsEntity.getPhotosImagePath()}}"
                                                                             alt="">
                                                                        <h5 class="align-middle"><span
                                                                                th:text="${item.getProductName()}"></span>
                                                                            (x[[${item.quantity}]])</h5>
                                                                    </td>
                                                                    <td><span
                                                                            th:text="${#numbers.formatDecimal(item.price  , 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                                    </td>
                                                                    <td>
                                                                        <span th:text="${#numbers.formatDecimal(item.getTotalPerProduct(), 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                                    </td>
                                                                </tr>
                                                                </tbody>
                                                                <tfoot>
                                                                <tr>
                                                                    <td class="order-pay-infor" colspan="2">Tổng tiền
                                                                        hàng
                                                                    </td>
                                                                    <td th:if="${order.codeId != null}"
                                                                        class="order-pay-fee">
                                                                        <span th:text="${#numbers.formatDecimal(order.totalPrice * 100 / (100 - order.discountCodeEntity.discountPercent), 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                                    </td>
                                                                    <td th:if="${order.codeId == null}"
                                                                        class="order-pay-fee">
                                                                        <span th:text="${#numbers.formatDecimal(order.totalPrice, 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                                    </td>
                                                                </tr>
                                                                <tr th:if="${order.codeId != null}">
                                                                    <td class="order-pay-infor" colspan="2">Giảm giá
                                                                    </td>
                                                                    <td class="order-pay-fee">
                                                                        [[${order.discountCodeEntity.discountPercent}]]
                                                                        %
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="order-pay-infor" colspan="2">Tổng số
                                                                        tiền
                                                                    </td>
                                                                    <td class="order-pay-fee">
                                                                        <span th:text="${#numbers.formatDecimal(order.totalPrice, 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td colspan="3" class="border-top">
                                                                        <button type="button"
                                                                                class="btn-reorder btn btn-primary text-right"
                                                                                th:onclick="buyOrderAgain([[${order.orderId}]], this)">
                                                                            Mua lại
                                                                        </button>
                                                                        <button th:if="${order.review_flg == false}"
                                                                                type="button"
                                                                                class="btn-review btn btn-primary text-right review-btn"
                                                                                data-toggle="modal"
                                                                                data-target="#reviewModalCenter"
                                                                                th:name="${order.orderId}">Đánh giá
                                                                        </button>
                                                                        <button th:if="${order.review_flg == true}"
                                                                                type="button"
                                                                                class="btn-review btn btn-primary text-right read-reviewed-btn"
                                                                                data-toggle="modal"
                                                                                data-target="#readReviewModalCenter"
                                                                                th:name="${order.orderId}">Xem đánh giá
                                                                        </button>
                                                                    </td>
                                                                </tr>
                                                                </tfoot>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </th:block>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade show" id="tabs-8" role="tabpanel">
                                        <div class="cancel-order">
                                            <th:block th:each="order : ${listOrderOfClient}">
                                                <div class="card mt-2 bg-light"
                                                     th:if="${order.status == T(com.treeshop.entity.StatusOfOrder).CANCELLED}">
                                                    <div>
                                                        <div class="card-header">
                                                            <div class="row">
                                                                <div class="col-lg-6">
                                                                    <a class="id-status-order">[[${order.orderId}]] | Đã
                                                                        hủy</a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="history__order__table card-body">
                                                            <table>
                                                                <thead>
                                                                <tr>
                                                                    <th class="shoping__product">Sản phẩm</th>
                                                                    <th>Đơn giá</th>
                                                                    <th>Tạm tính</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody>
                                                                <tr th:each="item : ${order.lineItemEntityList}">
                                                                    <td class="shoping__cart__item">
                                                                        <img th:src="@{${item.productsEntity.getPhotosImagePath()}}"
                                                                             alt="">
                                                                        <h5 class="align-middle"><span
                                                                                th:text="${item.getProductName()}"></span>
                                                                            (x[[${item.quantity}]])</h5>
                                                                    </td>
                                                                    <td><span
                                                                            th:text="${#numbers.formatDecimal(item.price  , 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                                    </td>
                                                                    <td>
                                                                        <span th:text="${#numbers.formatDecimal(item.getTotalPerProduct(), 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                                    </td>
                                                                </tr>
                                                                </tbody>
                                                                <tfoot>
                                                                <tr>
                                                                    <td class="order-pay-infor" colspan="2">Tổng tiền
                                                                        hàng
                                                                    </td>
                                                                    <td th:if="${order.codeId != null}"
                                                                        class="order-pay-fee">
                                                                        <span th:text="${#numbers.formatDecimal(order.totalPrice * 100 / (100 - order.discountCodeEntity.discountPercent), 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                                    </td>
                                                                    <td th:if="${order.codeId == null}"
                                                                        class="order-pay-fee">
                                                                        <span th:text="${#numbers.formatDecimal(order.totalPrice, 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                                    </td>
                                                                </tr>
                                                                <tr th:if="${order.codeId != null}">
                                                                    <td class="order-pay-infor" colspan="2">Giảm giá
                                                                    </td>
                                                                    <td class="order-pay-fee">
                                                                        [[${order.discountCodeEntity.discountPercent}]]
                                                                        %
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="order-pay-infor" colspan="2">Tổng số
                                                                        tiền
                                                                    </td>
                                                                    <td class="order-pay-fee">
                                                                        <span th:text="${#numbers.formatDecimal(order.totalPrice, 0, 'POINT', 0, 'POINT')} + '₫'"></span>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td colspan="3" class="border-top">
                                                                        <button type="button"
                                                                                class="btn-reorder btn btn-primary text-right"
                                                                                th:onclick="buyOrderAgain([[${order.orderId}]], this)">
                                                                            Mua lại
                                                                        </button>
                                                                    </td>
                                                                </tr>
                                                                </tfoot>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </th:block>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade show" id="tabs-4" role="tabpanel">
                            <div class="favourite-product">
                                <div class="p-1 py-4 al">
                                    <div class="d-flex justify-content-between align-items-center mb-3 border-bottom">
                                        <h4 class="text-right py-2 ">Sản phẩm yêu thích</h4>
                                    </div>
                                    <div class="favourite-product-list">
                                        <div class="row">
                                            <div class="favourite-product-item">
                                                <div class="card centered">
                                                    <div class="card-header">
                                                        <div class="delete-favourite-product">
                                                            <a href=""><i class="fa fa-times-circle"></i></a>
                                                        </div>
                                                    </div>
                                                    <div class="card-body">
                                                        <div class="row">
                                                            <div class="col-lg-2 col-sm-3">
                                                                <a href="shop-details.html">
                                                                    <img src="https://chaucanh.vn/kcfinder/upload/images/chau-canh-cay-canh-bonsai-la-mat-doc-dao(1).jpg"
                                                                         alt="">
                                                                </a>
                                                            </div>
                                                            <div class="col-lg-10 col-sm-9">
                                                                <span class="favourite-product-category">Cây văn phòng</span>
                                                                <h5><a href="shop-details.html">Cây bàng Singapore</a>
                                                                </h5>
                                                                <div class="favourite-product-price">695.000đ</div>
                                                                <div class="buy-now-product"><a
                                                                        href="shoping-cart.html"><i
                                                                        class="fa fa-shopping-cart"></i></a></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="favourite-product-item">
                                                <div class="card centered">
                                                    <div class="card-header">
                                                        <div class="delete-favourite-product">
                                                            <a href=""><i class="fa fa-times-circle"></i></a>
                                                        </div>
                                                    </div>
                                                    <div class="card-body">
                                                        <div class="row">
                                                            <div class="col-lg-2 col-sm-3">
                                                                <a href="shop-details.html">
                                                                    <img src="https://chaucanh.vn/kcfinder/upload/images/chau-canh-cay-canh-bonsai-la-mat-doc-dao(1).jpg"
                                                                         alt="">
                                                                </a>
                                                            </div>
                                                            <div class="col-lg-10 col-sm-9">
                                                                <span class="favourite-product-category">Cây văn phòng</span>
                                                                <h5><a href="shop-details.html">Cây bàng Singapore</a>
                                                                </h5>
                                                                <div class="favourite-product-price">695.000đ</div>
                                                                <div class="buy-now-product"><a
                                                                        href="shoping-cart.html"><i
                                                                        class="fa fa-shopping-cart"></i></a></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="favourite-product-item">
                                                <div class="card centered">
                                                    <div class="card-header">
                                                        <div class="delete-favourite-product">
                                                            <a href=""><i class="fa fa-times-circle"></i></a>
                                                        </div>
                                                    </div>
                                                    <div class="card-body">
                                                        <div class="row">
                                                            <div class="col-lg-2 col-sm-3">
                                                                <a href="shop-details.html">
                                                                    <img src="https://chaucanh.vn/kcfinder/upload/images/chau-canh-cay-canh-bonsai-la-mat-doc-dao(1).jpg"
                                                                         alt="">
                                                                </a>
                                                            </div>
                                                            <div class="col-lg-10 col-sm-9">
                                                                <span class="favourite-product-category">Cây văn phòng</span>
                                                                <h5><a href="shop-details.html">Cây bàng Singapore</a>
                                                                </h5>
                                                                <div class="favourite-product-price">695.000đ</div>
                                                                <div class="buy-now-product"><a
                                                                        href="shoping-cart.html"><i
                                                                        class="fa fa-shopping-cart"></i></a></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="favourite-product-item">
                                                <div class="card centered">
                                                    <div class="card-header">
                                                        <div class="delete-favourite-product">
                                                            <a href=""><i class="fa fa-times-circle"></i></a>
                                                        </div>
                                                    </div>
                                                    <div class="card-body">
                                                        <div class="row">
                                                            <div class="col-lg-2 col-sm-3">
                                                                <a href="shop-details.html">
                                                                    <img src="https://chaucanh.vn/kcfinder/upload/images/chau-canh-cay-canh-bonsai-la-mat-doc-dao(1).jpg"
                                                                         alt="">
                                                                </a>
                                                            </div>
                                                            <div class="col-lg-10 col-sm-9">
                                                                <span class="favourite-product-category">Cây văn phòng</span>
                                                                <h5><a href="shop-details.html">Cây bàng Singapore</a>
                                                                </h5>
                                                                <div class="favourite-product-price">695.000đ</div>
                                                                <div class="buy-now-product"><a
                                                                        href="shoping-cart.html"><i
                                                                        class="fa fa-shopping-cart"></i></i></a></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal -->
        <div class="cancel-notification modal fade" id="cancelModalCenter" tabindex="-1" role="dialog"
             aria-labelledby="cancelModalCenterTitle" aria-hidden="true" data-keyboard="false" data-backdrop="static">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLongTitle">Kết Quả Hủy Đơn</h5>
                        <!--                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">-->
                        <!--                            <span aria-hidden="true">&times;</span>-->
                        <!--                        </button>-->
                    </div>
                    <div class="modal-body">
                        <form class="centered">
                            <img th:src="@{/web/img/cancel-order.png}" class="img-fluid" alt="">
                            <div class="content-cancel-order" id="content-cancel-order">
                                <p>Đơn hàng của bạn đã được hủy thành công.</p>
                                <p>Treeshop hy vọng có thể phục vụ bạn trong tương lai.</p>
                            </div>
                            <a class="btn btn-primary text-center" id="continue-buy-btn" href="/home/list-web-product">Tiếp
                                tục mua hàng</a>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="review-product-modal modal fade" id="reviewModalCenter" tabindex="-1" role="dialog"
             aria-labelledby="reviewModalCenterTitle" aria-hidden="true" data-keyboard="false" data-backdrop="false">
            <div class="modal-dialog modal-dialog-centered" role="document" style="overflow-y: initial !important">
                <div class="modal-content review-modal">
                    <div class="modal-header">
                        <h5 class="modal-title" id="reviewModalLongTitle">Đánh Giá Sản Phẩm</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body" style="max-height: calc(100vh - 200px); overflow-y: auto;">
                        <!--                        <form>-->
                        <div class="list-product-review" id="list-product-review">
                            <!--                                <div class="item-product-review">-->
                            <!--                                    <div class="card">-->
                            <!--                                        <div class="card-header">-->
                            <!--                                            <div class="infor-product-review row">-->
                            <!--                                                <div class="col-lg-2 col-sm-2 col-3">-->
                            <!--                                                    <a href="shop-details.html"><img-->
                            <!--                                                            src="https://cayxinh.vn/wp-content/uploads/2019/11/thiet-moc-lan-131119.jpg"-->
                            <!--                                                            alt=""></a>-->
                            <!--                                                </div>-->
                            <!--                                                <div class="col-lg-10 col-sm-10 col-9">-->
                            <!--                                                    <div class="product-name-review"><a href="shop-details.html"><h5>Cây-->
                            <!--                                                        Thiết Mộc Lan</h5></a></div>-->
                            <!--                                                    <div class="product-category-review"><p>Cây Nội Thất</p></div>-->
                            <!--                                                </div>-->
                            <!--                                            </div>-->
                            <!--                                        </div>-->
                            <!--                                        <div class="card-body">-->
                            <!--                                            <div class="form-outline">-->
                            <!--                                            <textarea class="form-control" rows="3"-->
                            <!--                                                      placeholder="Hãy chia sẻ những điều bạn thích về sản phẩm này"></textarea>-->
                            <!--                                            </div>-->
                            <!--                                        </div>-->
                            <!--                                    </div>-->
                            <!--                                </div>-->
                            <!--                                </div>-->
                            <!--                                <div class="review-product-action text-right">-->
                            <!--                                    <button type="submit" class="btn btn-primary text-center"-->
                            <!--                                            style="background: #7fad39;color: #ffffff; border-width: 1px;border-color: #7fad39;font-size: 14px;">-->
                            <!--                                        Hoàn Thành-->
                            <!--                                    </button>-->
                            <!--                                </div>-->
                        </div>
                        <!--                        </form>-->
                    </div>
                </div>
            </div>
        </div>
        <div class="review-product-modal modal fade" id="readReviewModalCenter" tabindex="-1" role="dialog"
             aria-labelledby="reviewModalCenterTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document" style="overflow-y: initial !important">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="readReviewModalLongTitle">Xem Đánh Giá Sản Phẩm</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body" style="max-height: calc(100vh - 200px); overflow-y: auto;">
                        <div class="list-product-review" id="list-product-reviewed">
                            <div class="item-product-review">
                                <div class="card">
                                    <div class="card-header">
                                        <div class="infor-product-review row">
                                            <div class="col-lg-2 col-sm-2 col-3">
                                                <a href="shop-details.html"><img
                                                        src="https://cayxinh.vn/wp-content/uploads/2019/11/thiet-moc-lan-131119.jpg"
                                                        alt=""></a>
                                            </div>
                                            <div class="col-lg-10 col-sm-10 col-9">
                                                <div class="product-name-review"><a href="shop-details.html"><h5>Cây
                                                    Thiết Mộc Lan</h5></a></div>
                                                <div class="product-category-review"><p>Cây Nội Thất</p></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-body">
                                        <div class="form-outline">
                                                                        <textarea class="form-control" rows="3"
                                                                                  placeholder="Hãy chia sẻ những điều bạn thích về sản phẩm này"></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--                                <div class="review-product-action text-right">-->
                        <!--                                    <button type="submit" class="btn btn-primary text-center"-->
                        <!--                                            style="background: #7fad39;color: #ffffff; border-width: 1px;border-color: #7fad39;font-size: 14px;">-->
                        <!--                                        Hoàn Thành-->
                        <!--                                    </button>-->
                        <!--                                </div>-->
                    </div>
                </div>
            </div>
        </div>
    </section>
    <script th:unless="${session.client}" type="text/javascript" th:inline="javascript">
        checkClientSession();
    </script>
    <script th:if="${alert}" type="text/javascript" th:inline="javascript">
        alert([[${alert}]]);
    </script>
    <script th:if="${session.client}" type="text/javascript" th:inline="javascript">
        let username = [[${session.client.username}]];

        function checkPass() {
            let newPassword = $('#newPass').val();
            let conFPassword = $('#conFPass').val();
            let message = $('#message');
            let submitPassword = $('#submit-password');
            if (newPassword === conFPassword) {
                message.html("");
                submitPassword.prop("disabled", false);
            } else {
                message.html("Mật khẩu không trùng khớp");
                message.css({'color': 'red', 'font': 'Times'});
                submitPassword.prop("disabled", true);
            }
        }

        function changePassword() {
            let oldPassword = $('#oldPassword').val();
            let newPassword = $('#newPass').val();
            let conFPassword = $('#conFPass').val();
            let message = $('#message');
            if (oldPassword === "" || newPassword === "" || conFPassword === "") {
                message.html("Thông tin nhập còn trống");
                message.css({'color': 'red', 'font': 'Times'});
            } else {
                let url = "/home/save/" + username + "/password";
                let password = {
                    "oldP": oldPassword,
                    "newP": newPassword
                }
                $.ajax({
                    type: "post",
                    url: url,
                    data: password
                }).done(function (check) {
                    if (check) {
                        $('#oldPassword').val("");
                        $('#newPass').val("");
                        $('#conFPass').val("");
                        message.html("");
                        alert("Thay đổi mật khẩu thành công, mời bạn đăng nhập lại với mật khẩu mới!");
                        window.location.assign("/home/user/logout");
                    } else {
                        message.html("");
                        alert("Bạn đã nhập sai mật khẩu cũ");
                    }
                })
            }
        }

        function buyOrderAgain(orderId, button) {
            let url = "/home/buy-again/" + username + "/" + orderId;
            $.ajax({
                type: "post",
                url: url
            }).done(function (list) {
                let quantityOfProduct = $(button).parents('table:first').find('tbody >tr').length;
                let listSize = list.length;

                function addItemToCart() {
                    let url = "/home/" + username + "/add-item-to-cart/" + orderId;
                    $.ajax({
                        type: "post",
                        url: url,
                        contentType: "application/json",
                        data: JSON.stringify(list)
                    }).done(function (isSuccess) {
                        if (isSuccess) {
                            alert("Thành công!");
                            url = "/home/" + username + "/cart/detail";
                            window.location.assign(url);
                        } else {
                            alert("Có lỗi xảy ra, thất bại!");
                        }
                    })
                }

                if (listSize === quantityOfProduct) {
                    alert("Tất cả sản phẩm hiện không còn bán nữa!");
                } else if (listSize === 0) {
                    addItemToCart();
                } else {
                    let listStr = "";
                    list.forEach(function (element) {
                        listStr += element.productName + " ";
                    });
                    let message = "Sản phẩm " + listStr + "hiện không còn bán nữa!\n Bạn có muốn mua lại số sản phẩm còn lại không? ^^";
                    let confirmAction = confirm(message);
                    if (confirmAction) {
                        addItemToCart();
                    }
                }
            })
        }

        let reviewBtn;
        // Review product
        $('.review-btn').on('click', function () {
            let orderId = $(this)[0].name;
            let url = "/home/" + orderId + "/line-item/detail";
            reviewBtn = $(this);
            $.ajax({
                type: "get",
                url: url
            }).done(function (list) {
                $('#list-product-review').html("");
                let urlOrigin = window.location.origin;
                list.forEach(function (element) {
                    let productHref = "/home/product/" + element.productId + "/detail";
                    let srcImage = urlOrigin + element.photosImagePath;
                    let productName = element.productName;
                    let productId = element.productId;
                    let categoryName = element.categoryName;
                    $('#list-product-review').append("<div class=\"item-product-review\" id=" + productId + ">\n" +
                        "                                    <div class=\"card\">\n" +
                        "                                        <div class=\"card-header\">\n" +
                        "                                            <div class=\"infor-product-review row\">\n" +
                        "                                                <div class=\"col-lg-2 col-sm-2 col-3\">\n" +
                        "                                                    <a href=" + productHref + "><img\n" +
                        "                                                            src=" + srcImage + "\n" +
                        "                                                            alt=\"\"></a>\n" +
                        "                                                </div>\n" +
                        "                                                <div class=\"col-lg-10 col-sm-10 col-9\">\n" +
                        "                                                    <div class=\"product-name-review\"><a href=" + productHref + "><h5>" + productName + "</h5></a></div>\n" +
                        "                                                    <div class=\"product-category-review\"><p>" + categoryName + "</p></div>\n" +
                        "                                                </div>\n" +
                        "                                            </div>\n" +
                        "                                        </div>\n" +
                        "                                        <div class=\"card-body\">\n" +
                        "                                            <div class=\"form-outline\">\n" +
                        "                                            <textarea class=\"form-control comment-content\" rows=\"3\"\n" +
                        "                                                      placeholder=\"Hãy chia sẻ những điều bạn thích về sản phẩm này\"></textarea>\n" +
                        "                                            </div>\n" +
                        "                                        </div>\n" +
                        "                                    </div>\n" +
                        "                                </div>");
                });
                $('#list-product-review').append(" <div class=\"review-product-action text-right\">\n" +
                    "                                    <button type=\"button\" class=\"btn btn-primary text-center\" onclick=" + "submitReviews(this,'" + orderId + "')" +
                    "                                            style=\"background: #7fad39;color: #ffffff; border-width: 1px;border-color: #7fad39;font-size: 14px;\">\n" +
                    "                                        Hoàn Thành\n" +
                    "                                    </button>\n" +
                    "                                </div>");
            })
        });

        //Submit reviews
        function submitReviews(submitBtn, orderId) {
            let id;
            let data;
            let dataList = [];
            let checkNoContent = false;

            let itemProductObject = $(submitBtn).parents('#list-product-review').children('.item-product-review');
            delete itemProductObject.length;
            delete itemProductObject.prevObject;

            let itemProductArr = Object.entries(itemProductObject);
            itemProductArr.forEach(function (element) {
                let div = element[1];
                let productId = div.id;
                let content = $(div).find(".comment-content")[0].value;
                if (content === "") {
                    checkNoContent = true;
                    return;
                }
                id = {productId: productId, orderId: orderId};
                data = {reviewsIdKey: id, content: content};
                dataList.push(data);
                // console.log(data);
            });
            if (checkNoContent) {
                alert("Có sản phẩm chưa nhập nội dung review, mời bạn kiểm tra lại");
            } else {
                let url = "/home/" + orderId + "/review";
                $.ajax({
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    type: "post",
                    url: url,
                    data: JSON.stringify(dataList)
                }).done(function (isSuccess) {
                    if (isSuccess) {
                        alert("Đánh giá thành công, cảm ơn bạn đã ủng hộ ^^");
                        $('#reviewModalCenter').modal('hide');
                        reviewBtn.parent().append("<button onclick='readReview(this)' type=\"button\"\n" +
                            "                                class=\"btn-review btn btn-primary text-right read-reviewed-btn\"\n" +
                            "                                data-toggle=\"modal\"\n" +
                            "                                data-target=\"#readReviewModalCenter\"\n" +
                            "                                name=" + orderId + ">Xem đánh giá\n" +
                            "                        </button>");
                        reviewBtn.remove();
                    } else {
                        alert("Gặp lỗi, hiện không thể đánh giá");
                    }
                })
            }
        }
        function readReview(btnReadReview){
            let orderId = $(btnReadReview)[0].name;
            let url = "/home/" + orderId + "/read/review";
            $.ajax({
                type: "get",
                url: url
            }).done(function (list) {
                $('#list-product-reviewed').html("");
                let urlOrigin = window.location.origin;
                list.forEach(function (element) {
                    let productHref = "/home/product/" + element.productId + "/detail";
                    let srcImage = urlOrigin + element.photosImagePath;
                    let productName = element.productName;
                    let productId = element.productId;
                    let categoryName = element.categoryName;
                    let content = element.content;
                    $('#list-product-reviewed').append("<div class=\"item-product-review\" id=" + productId + ">\n" +
                        "                                    <div class=\"card\">\n" +
                        "                                        <div class=\"card-header\">\n" +
                        "                                            <div class=\"infor-product-review row\">\n" +
                        "                                                <div class=\"col-lg-2 col-sm-2 col-3\">\n" +
                        "                                                    <a href=" + productHref + "><img\n" +
                        "                                                            src=" + srcImage + "\n" +
                        "                                                            alt=\"\"></a>\n" +
                        "                                                </div>\n" +
                        "                                                <div class=\"col-lg-10 col-sm-10 col-9\">\n" +
                        "                                                    <div class=\"product-name-review\"><a href=" + productHref + "><h5>" + productName + "</h5></a></div>\n" +
                        "                                                    <div class=\"product-category-review\"><p>" + categoryName + "</p></div>\n" +
                        "                                                </div>\n" +
                        "                                            </div>\n" +
                        "                                        </div>\n" +
                        "                                        <div class=\"card-body\">\n" +
                        "                                            <div class=\"form-outline\">\n" +
                        "                                            <textarea class=\"form-control comment-content\" rows=\"3\"\n" +
                        "                                                      disabled>" + content + "</textarea>\n" +
                        "                                            </div>\n" +
                        "                                        </div>\n" +
                        "                                    </div>\n" +
                        "                                </div>");
                });
            })
        }
        // Read review order
        $('.read-reviewed-btn').on('click', function () {
            readReview(this);
        });

        // Cancel order
        $('.cancel-order-btn').on('click', function () {
            let orderId = $(this)[0].id;
            let url = "/home/information/cancel-order/" + orderId;

            $.ajax({
                type: "post",
                url: url
            }).done(function (isSuccess) {
                if (isSuccess) {
                    $('#content-cancel-order').html('<p>Đơn hàng của bạn đã được hủy thành công.</p>\n' +
                        '<p>Treeshop hy vọng có thể phục vụ bạn trong tương lai.</p>')
                } else {
                    $('#content-cancel-order').html('<p style="color: red">Không thể hủy đơn hàng vì đã được xác nhận này!</p>\n' +
                        '<p>Hãy liên hệ admin để được hỗ trợ!</p>')
                }
            })
        });
    </script>
    <script type="text/javascript" th:inline="javascript">
        $(document).ready(function () {
            const arr = ['.delivering-order', '.waiting-order', '.all-order', '.cancel-order', '.success-order'];
            arr.forEach(function (item) {
                if ($(item).find('.card').length === 0) {
                    $(item).append("<div class=\"no-order\">\n" +
                        "                                            <form class=\"centered\">\n" +
                        "                                                <img src=\"/web/img/empty-deliver-removebg-preview.png\"\n" +
                        "                                                     class=\"img-fluid\" alt=\"\">\n" +
                        "                                                <p class=\"text-center\">Chưa có đơn hàng</p>\n" +
                        "                                                <a class=\"btn btn-primary text-center\" href=\"/home/list-web-product\">Tiếp tục mua hàng</a>\n" +
                        "                                            </form>\n" +
                        "                                        </div>")
                }
            });
        })
    </script>
</div>

</body>
</html>